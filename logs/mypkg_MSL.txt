2024-05-01 13:04:55.844024: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-05-01 13:04:55.844051: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-05-01 13:04:55.844057: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-05-01 13:04:55.848082: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE4.1 SSE4.2 AVX AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
{'dataset': 'mypkg_MSL', 'group': '1-1', 'lookback': 100, 'normalize': True, 'spec_res': False, 'kernel_size': 7, 'use_gatv2': True, 'feat_gat_embed_dim': None, 'time_gat_embed_dim': None, 'gru_n_layers': 1, 'gru_hid_dim': 150, 'fc_n_layers': 3, 'fc_hid_dim': 150, 'recon_n_layers': 1, 'recon_hid_dim': 150, 'alpha': 0.2, 'epochs': 30, 'val_split': 0.1, 'bs': 256, 'init_lr': 0.001, 'shuffle_dataset': True, 'dropout': 0.3, 'use_cuda': True, 'print_every': 1, 'log_tensorboard': True, 'scale_scores': False, 'use_mov_av': False, 'gamma': 1, 'level': None, 'q': None, 'dynamic_pot': False, 'comment': ''}
load data of: mypkg_MSL
train:  0 None
test:  0 None
Data normalized
Data normalized
train set shape:  (58317, 55)
test set shape:  (73729, 55)
test set label shape:  (73729,)
Will forecast and reconstruct input features: [0]
train_size: 52396
validation_size: 5821
test_size: 73629
Init total train loss: 0.616391
Init total val loss: 0.61676
Training model for 30 epochs..
[Epoch 1] forecast_loss = 0.08721, recon_loss = 0.10318, total_loss = 0.19039 ---- val_forecast_loss = 0.04445, val_recon_loss = 0.05921, val_total_loss = 0.10367 [14.5s]
[Epoch 2] forecast_loss = 0.04930, recon_loss = 0.05775, total_loss = 0.10706 ---- val_forecast_loss = 0.04552, val_recon_loss = 0.05630, val_total_loss = 0.10182 [14.7s]
[Epoch 3] forecast_loss = 0.04649, recon_loss = 0.05417, total_loss = 0.10066 ---- val_forecast_loss = 0.04054, val_recon_loss = 0.05213, val_total_loss = 0.09267 [14.8s]
[Epoch 4] forecast_loss = 0.04465, recon_loss = 0.05011, total_loss = 0.09475 ---- val_forecast_loss = 0.04003, val_recon_loss = 0.04763, val_total_loss = 0.08765 [15.1s]
[Epoch 5] forecast_loss = 0.04336, recon_loss = 0.04680, total_loss = 0.09015 ---- val_forecast_loss = 0.03885, val_recon_loss = 0.04602, val_total_loss = 0.08486 [15.1s]
[Epoch 6] forecast_loss = 0.04246, recon_loss = 0.04504, total_loss = 0.08750 ---- val_forecast_loss = 0.04062, val_recon_loss = 0.04465, val_total_loss = 0.08527 [15.0s]
[Epoch 7] forecast_loss = 0.04172, recon_loss = 0.04423, total_loss = 0.08595 ---- val_forecast_loss = 0.03924, val_recon_loss = 0.04298, val_total_loss = 0.08222 [15.2s]
[Epoch 8] forecast_loss = 0.04098, recon_loss = 0.04273, total_loss = 0.08371 ---- val_forecast_loss = 0.03849, val_recon_loss = 0.04206, val_total_loss = 0.08055 [15.2s]
[Epoch 9] forecast_loss = 0.04063, recon_loss = 0.04226, total_loss = 0.08289 ---- val_forecast_loss = 0.03722, val_recon_loss = 0.04126, val_total_loss = 0.07848 [15.1s]
[Epoch 10] forecast_loss = 0.03989, recon_loss = 0.04109, total_loss = 0.08098 ---- val_forecast_loss = 0.03796, val_recon_loss = 0.04032, val_total_loss = 0.07828 [15.2s]
[Epoch 11] forecast_loss = 0.03995, recon_loss = 0.04071, total_loss = 0.08066 ---- val_forecast_loss = 0.03852, val_recon_loss = 0.04094, val_total_loss = 0.07946 [15.1s]
[Epoch 12] forecast_loss = 0.03927, recon_loss = 0.03969, total_loss = 0.07896 ---- val_forecast_loss = 0.03587, val_recon_loss = 0.03926, val_total_loss = 0.07513 [15.2s]
[Epoch 13] forecast_loss = 0.03907, recon_loss = 0.03995, total_loss = 0.07903 ---- val_forecast_loss = 0.03577, val_recon_loss = 0.03906, val_total_loss = 0.07483 [15.2s]
[Epoch 14] forecast_loss = 0.03860, recon_loss = 0.03876, total_loss = 0.07736 ---- val_forecast_loss = 0.03674, val_recon_loss = 0.03835, val_total_loss = 0.07510 [15.1s]
[Epoch 15] forecast_loss = 0.03835, recon_loss = 0.03857, total_loss = 0.07692 ---- val_forecast_loss = 0.03587, val_recon_loss = 0.03904, val_total_loss = 0.07491 [15.2s]
[Epoch 16] forecast_loss = 0.03800, recon_loss = 0.03799, total_loss = 0.07599 ---- val_forecast_loss = 0.03577, val_recon_loss = 0.03802, val_total_loss = 0.07380 [15.1s]
[Epoch 17] forecast_loss = 0.03770, recon_loss = 0.03882, total_loss = 0.07651 ---- val_forecast_loss = 0.03575, val_recon_loss = 0.03723, val_total_loss = 0.07298 [15.2s]
[Epoch 18] forecast_loss = 0.03709, recon_loss = 0.03748, total_loss = 0.07457 ---- val_forecast_loss = 0.03698, val_recon_loss = 0.03677, val_total_loss = 0.07375 [15.2s]
[Epoch 19] forecast_loss = 0.03726, recon_loss = 0.03717, total_loss = 0.07443 ---- val_forecast_loss = 0.03782, val_recon_loss = 0.03737, val_total_loss = 0.07519 [15.0s]
[Epoch 20] forecast_loss = 0.03702, recon_loss = 0.03671, total_loss = 0.07374 ---- val_forecast_loss = 0.03593, val_recon_loss = 0.03597, val_total_loss = 0.07190 [15.1s]
[Epoch 21] forecast_loss = 0.03618, recon_loss = 0.03669, total_loss = 0.07286 ---- val_forecast_loss = 0.03647, val_recon_loss = 0.03689, val_total_loss = 0.07336 [15.0s]
[Epoch 22] forecast_loss = 0.03600, recon_loss = 0.03628, total_loss = 0.07227 ---- val_forecast_loss = 0.03870, val_recon_loss = 0.03636, val_total_loss = 0.07505 [15.1s]
[Epoch 23] forecast_loss = 0.03591, recon_loss = 0.03604, total_loss = 0.07195 ---- val_forecast_loss = 0.03606, val_recon_loss = 0.03525, val_total_loss = 0.07131 [15.1s]
[Epoch 24] forecast_loss = 0.03574, recon_loss = 0.03588, total_loss = 0.07161 ---- val_forecast_loss = 0.03591, val_recon_loss = 0.03525, val_total_loss = 0.07117 [14.9s]
[Epoch 25] forecast_loss = 0.03574, recon_loss = 0.03535, total_loss = 0.07109 ---- val_forecast_loss = 0.03586, val_recon_loss = 0.03417, val_total_loss = 0.07003 [15.0s]
[Epoch 26] forecast_loss = 0.03513, recon_loss = 0.03519, total_loss = 0.07032 ---- val_forecast_loss = 0.03534, val_recon_loss = 0.03513, val_total_loss = 0.07047 [15.0s]
[Epoch 27] forecast_loss = 0.03500, recon_loss = 0.03464, total_loss = 0.06964 ---- val_forecast_loss = 0.03768, val_recon_loss = 0.03349, val_total_loss = 0.07117 [15.0s]
[Epoch 28] forecast_loss = 0.03548, recon_loss = 0.03451, total_loss = 0.06999 ---- val_forecast_loss = 0.03795, val_recon_loss = 0.03375, val_total_loss = 0.07169 [15.0s]
[Epoch 29] forecast_loss = 0.03479, recon_loss = 0.03471, total_loss = 0.06950 ---- val_forecast_loss = 0.03941, val_recon_loss = 0.03445, val_total_loss = 0.07386 [14.9s]
[Epoch 30] forecast_loss = 0.03462, recon_loss = 0.03390, total_loss = 0.06852 ---- val_forecast_loss = 0.03686, val_recon_loss = 0.03392, val_total_loss = 0.07078 [15.0s]
-- Training done in 451s.
Test forecast loss: 1.10638
Test reconstruction loss: 1.14980
Test total loss: 2.25618
Predicting and calculating anomaly scores..
  0%|          | 0/228 [00:00<?, ?it/s]  1%|          | 2/228 [00:00<00:13, 16.55it/s]  2%|▏         | 4/228 [00:00<00:13, 16.51it/s]  3%|▎         | 6/228 [00:00<00:13, 16.52it/s]  4%|▎         | 8/228 [00:00<00:13, 16.51it/s]  4%|▍         | 10/228 [00:00<00:13, 16.50it/s]  5%|▌         | 12/228 [00:00<00:13, 16.50it/s]  6%|▌         | 14/228 [00:00<00:12, 16.50it/s]  7%|▋         | 16/228 [00:00<00:12, 16.49it/s]  8%|▊         | 18/228 [00:01<00:12, 16.48it/s]  9%|▉         | 20/228 [00:01<00:12, 16.47it/s] 10%|▉         | 22/228 [00:01<00:12, 16.51it/s] 11%|█         | 24/228 [00:01<00:12, 16.52it/s] 11%|█▏        | 26/228 [00:01<00:12, 16.53it/s] 12%|█▏        | 28/228 [00:01<00:12, 16.55it/s] 13%|█▎        | 30/228 [00:01<00:11, 16.55it/s] 14%|█▍        | 32/228 [00:01<00:11, 16.55it/s] 15%|█▍        | 34/228 [00:02<00:11, 16.53it/s] 16%|█▌        | 36/228 [00:02<00:11, 16.51it/s] 17%|█▋        | 38/228 [00:02<00:11, 16.49it/s] 18%|█▊        | 40/228 [00:02<00:11, 16.50it/s] 18%|█▊        | 42/228 [00:02<00:11, 16.51it/s] 19%|█▉        | 44/228 [00:02<00:11, 16.50it/s] 20%|██        | 46/228 [00:02<00:11, 16.50it/s] 21%|██        | 48/228 [00:02<00:10, 16.51it/s] 22%|██▏       | 50/228 [00:03<00:10, 16.52it/s] 23%|██▎       | 52/228 [00:03<00:10, 16.52it/s] 24%|██▎       | 54/228 [00:03<00:10, 16.52it/s] 25%|██▍       | 56/228 [00:03<00:10, 16.52it/s] 25%|██▌       | 58/228 [00:03<00:10, 16.52it/s] 26%|██▋       | 60/228 [00:03<00:10, 16.53it/s] 27%|██▋       | 62/228 [00:03<00:10, 16.54it/s] 28%|██▊       | 64/228 [00:03<00:09, 16.55it/s] 29%|██▉       | 66/228 [00:03<00:09, 16.56it/s] 30%|██▉       | 68/228 [00:04<00:09, 16.55it/s] 31%|███       | 70/228 [00:04<00:09, 16.55it/s] 32%|███▏      | 72/228 [00:04<00:09, 16.47it/s] 32%|███▏      | 74/228 [00:04<00:09, 16.45it/s] 33%|███▎      | 76/228 [00:04<00:09, 16.47it/s] 34%|███▍      | 78/228 [00:04<00:09, 16.48it/s] 35%|███▌      | 80/228 [00:04<00:09, 16.40it/s] 36%|███▌      | 82/228 [00:04<00:08, 16.43it/s] 37%|███▋      | 84/228 [00:05<00:08, 16.45it/s] 38%|███▊      | 86/228 [00:05<00:08, 16.46it/s] 39%|███▊      | 88/228 [00:05<00:08, 16.47it/s] 39%|███▉      | 90/228 [00:05<00:08, 16.48it/s] 40%|████      | 92/228 [00:05<00:08, 16.50it/s] 41%|████      | 94/228 [00:05<00:08, 16.50it/s] 42%|████▏     | 96/228 [00:05<00:08, 16.50it/s] 43%|████▎     | 98/228 [00:05<00:07, 16.47it/s] 44%|████▍     | 100/228 [00:06<00:07, 16.47it/s] 45%|████▍     | 102/228 [00:06<00:07, 16.47it/s] 46%|████▌     | 104/228 [00:06<00:07, 16.46it/s] 46%|████▋     | 106/228 [00:06<00:07, 16.45it/s] 47%|████▋     | 108/228 [00:06<00:07, 16.45it/s] 48%|████▊     | 110/228 [00:06<00:07, 16.45it/s] 49%|████▉     | 112/228 [00:06<00:07, 16.44it/s] 50%|█████     | 114/228 [00:06<00:06, 16.43it/s] 51%|█████     | 116/228 [00:07<00:06, 16.44it/s] 52%|█████▏    | 118/228 [00:07<00:06, 16.45it/s] 53%|█████▎    | 120/228 [00:07<00:06, 16.46it/s] 54%|█████▎    | 122/228 [00:07<00:06, 16.45it/s] 54%|█████▍    | 124/228 [00:07<00:06, 16.45it/s] 55%|█████▌    | 126/228 [00:07<00:06, 16.46it/s] 56%|█████▌    | 128/228 [00:07<00:06, 16.45it/s] 57%|█████▋    | 130/228 [00:07<00:05, 16.46it/s] 58%|█████▊    | 132/228 [00:08<00:05, 16.47it/s] 59%|█████▉    | 134/228 [00:08<00:05, 16.47it/s] 60%|█████▉    | 136/228 [00:08<00:05, 16.47it/s] 61%|██████    | 138/228 [00:08<00:05, 16.44it/s] 61%|██████▏   | 140/228 [00:08<00:05, 16.46it/s] 62%|██████▏   | 142/228 [00:08<00:05, 16.48it/s] 63%|██████▎   | 144/228 [00:08<00:05, 16.49it/s] 64%|██████▍   | 146/228 [00:08<00:04, 16.50it/s] 65%|██████▍   | 148/228 [00:08<00:04, 16.49it/s] 66%|██████▌   | 150/228 [00:09<00:04, 16.47it/s] 67%|██████▋   | 152/228 [00:09<00:04, 16.45it/s] 68%|██████▊   | 154/228 [00:09<00:04, 16.44it/s] 68%|██████▊   | 156/228 [00:09<00:04, 16.44it/s] 69%|██████▉   | 158/228 [00:09<00:04, 16.46it/s] 70%|███████   | 160/228 [00:09<00:04, 16.48it/s] 71%|███████   | 162/228 [00:09<00:04, 16.48it/s] 72%|███████▏  | 164/228 [00:09<00:03, 16.48it/s] 73%|███████▎  | 166/228 [00:10<00:03, 16.48it/s] 74%|███████▎  | 168/228 [00:10<00:03, 16.48it/s] 75%|███████▍  | 170/228 [00:10<00:03, 16.49it/s] 75%|███████▌  | 172/228 [00:10<00:03, 16.51it/s] 76%|███████▋  | 174/228 [00:10<00:03, 16.53it/s] 77%|███████▋  | 176/228 [00:10<00:03, 16.54it/s] 78%|███████▊  | 178/228 [00:10<00:03, 16.54it/s] 79%|███████▉  | 180/228 [00:10<00:02, 16.52it/s] 80%|███████▉  | 182/228 [00:11<00:02, 16.51it/s] 81%|████████  | 184/228 [00:11<00:02, 16.51it/s] 82%|████████▏ | 186/228 [00:11<00:02, 16.52it/s] 82%|████████▏ | 188/228 [00:11<00:02, 16.51it/s] 83%|████████▎ | 190/228 [00:11<00:02, 16.51it/s] 84%|████████▍ | 192/228 [00:11<00:02, 16.50it/s] 85%|████████▌ | 194/228 [00:11<00:02, 16.50it/s] 86%|████████▌ | 196/228 [00:11<00:01, 16.48it/s] 87%|████████▋ | 198/228 [00:12<00:01, 16.46it/s] 88%|████████▊ | 200/228 [00:12<00:01, 16.46it/s] 89%|████████▊ | 202/228 [00:12<00:01, 16.46it/s] 89%|████████▉ | 204/228 [00:12<00:01, 16.47it/s] 90%|█████████ | 206/228 [00:12<00:01, 16.47it/s] 91%|█████████ | 208/228 [00:12<00:01, 16.46it/s] 92%|█████████▏| 210/228 [00:12<00:01, 16.44it/s] 93%|█████████▎| 212/228 [00:12<00:00, 16.44it/s] 94%|█████████▍| 214/228 [00:12<00:00, 16.44it/s] 95%|█████████▍| 216/228 [00:13<00:00, 16.44it/s] 96%|█████████▌| 218/228 [00:13<00:00, 16.46it/s] 96%|█████████▋| 220/228 [00:13<00:00, 16.46it/s] 97%|█████████▋| 222/228 [00:13<00:00, 16.45it/s] 98%|█████████▊| 224/228 [00:13<00:00, 16.46it/s] 99%|█████████▉| 226/228 [00:13<00:00, 16.48it/s]100%|██████████| 228/228 [00:13<00:00, 16.53it/s]
Predicting and calculating anomaly scores..
  0%|          | 0/288 [00:00<?, ?it/s]  1%|          | 2/288 [00:00<00:17, 16.28it/s]  1%|▏         | 4/288 [00:00<00:17, 16.30it/s]  2%|▏         | 6/288 [00:00<00:17, 16.29it/s]  3%|▎         | 8/288 [00:00<00:17, 16.29it/s]  3%|▎         | 10/288 [00:00<00:17, 16.25it/s]  4%|▍         | 12/288 [00:00<00:16, 16.25it/s]  5%|▍         | 14/288 [00:00<00:16, 16.26it/s]  6%|▌         | 16/288 [00:00<00:16, 16.27it/s]  6%|▋         | 18/288 [00:01<00:16, 16.28it/s]  7%|▋         | 20/288 [00:01<00:16, 16.28it/s]  8%|▊         | 22/288 [00:01<00:16, 16.29it/s]  8%|▊         | 24/288 [00:01<00:16, 16.31it/s]  9%|▉         | 26/288 [00:01<00:16, 16.30it/s] 10%|▉         | 28/288 [00:01<00:15, 16.30it/s] 10%|█         | 30/288 [00:01<00:15, 16.28it/s] 11%|█         | 32/288 [00:01<00:15, 16.28it/s] 12%|█▏        | 34/288 [00:02<00:15, 16.28it/s] 12%|█▎        | 36/288 [00:02<00:15, 16.29it/s] 13%|█▎        | 38/288 [00:02<00:15, 16.30it/s] 14%|█▍        | 40/288 [00:02<00:15, 16.30it/s] 15%|█▍        | 42/288 [00:02<00:15, 16.31it/s] 15%|█▌        | 44/288 [00:02<00:14, 16.32it/s] 16%|█▌        | 46/288 [00:02<00:14, 16.32it/s] 17%|█▋        | 48/288 [00:02<00:14, 16.33it/s] 17%|█▋        | 50/288 [00:03<00:14, 16.33it/s] 18%|█▊        | 52/288 [00:03<00:14, 16.34it/s] 19%|█▉        | 54/288 [00:03<00:14, 16.35it/s] 19%|█▉        | 56/288 [00:03<00:14, 16.35it/s] 20%|██        | 58/288 [00:03<00:14, 16.34it/s] 21%|██        | 60/288 [00:03<00:13, 16.34it/s] 22%|██▏       | 62/288 [00:03<00:13, 16.32it/s] 22%|██▏       | 64/288 [00:03<00:13, 16.32it/s] 23%|██▎       | 66/288 [00:04<00:13, 16.31it/s] 24%|██▎       | 68/288 [00:04<00:13, 16.32it/s] 24%|██▍       | 70/288 [00:04<00:13, 16.33it/s] 25%|██▌       | 72/288 [00:04<00:13, 16.33it/s] 26%|██▌       | 74/288 [00:04<00:13, 16.33it/s] 26%|██▋       | 76/288 [00:04<00:12, 16.32it/s] 27%|██▋       | 78/288 [00:04<00:12, 16.33it/s] 28%|██▊       | 80/288 [00:04<00:12, 16.34it/s] 28%|██▊       | 82/288 [00:05<00:12, 16.33it/s] 29%|██▉       | 84/288 [00:05<00:12, 16.33it/s] 30%|██▉       | 86/288 [00:05<00:12, 16.34it/s] 31%|███       | 88/288 [00:05<00:12, 16.33it/s] 31%|███▏      | 90/288 [00:05<00:12, 16.33it/s] 32%|███▏      | 92/288 [00:05<00:12, 16.33it/s] 33%|███▎      | 94/288 [00:05<00:11, 16.34it/s] 33%|███▎      | 96/288 [00:05<00:11, 16.34it/s] 34%|███▍      | 98/288 [00:06<00:11, 16.33it/s] 35%|███▍      | 100/288 [00:06<00:11, 16.32it/s] 35%|███▌      | 102/288 [00:06<00:11, 16.33it/s] 36%|███▌      | 104/288 [00:06<00:11, 16.32it/s] 37%|███▋      | 106/288 [00:06<00:11, 16.31it/s] 38%|███▊      | 108/288 [00:06<00:11, 16.30it/s] 38%|███▊      | 110/288 [00:06<00:10, 16.29it/s] 39%|███▉      | 112/288 [00:06<00:10, 16.29it/s] 40%|███▉      | 114/288 [00:06<00:10, 16.29it/s] 40%|████      | 116/288 [00:07<00:10, 16.30it/s] 41%|████      | 118/288 [00:07<00:10, 16.30it/s] 42%|████▏     | 120/288 [00:07<00:10, 16.29it/s] 42%|████▏     | 122/288 [00:07<00:10, 16.27it/s] 43%|████▎     | 124/288 [00:07<00:10, 16.28it/s] 44%|████▍     | 126/288 [00:07<00:09, 16.28it/s] 44%|████▍     | 128/288 [00:07<00:09, 16.28it/s] 45%|████▌     | 130/288 [00:07<00:09, 16.29it/s] 46%|████▌     | 132/288 [00:08<00:09, 16.29it/s] 47%|████▋     | 134/288 [00:08<00:09, 16.29it/s] 47%|████▋     | 136/288 [00:08<00:09, 16.28it/s] 48%|████▊     | 138/288 [00:08<00:09, 16.28it/s] 49%|████▊     | 140/288 [00:08<00:09, 16.27it/s] 49%|████▉     | 142/288 [00:08<00:08, 16.27it/s] 50%|█████     | 144/288 [00:08<00:08, 16.26it/s] 51%|█████     | 146/288 [00:08<00:08, 16.25it/s] 51%|█████▏    | 148/288 [00:09<00:08, 16.25it/s] 52%|█████▏    | 150/288 [00:09<00:08, 16.26it/s] 53%|█████▎    | 152/288 [00:09<00:08, 16.27it/s] 53%|█████▎    | 154/288 [00:09<00:08, 16.27it/s] 54%|█████▍    | 156/288 [00:09<00:08, 16.29it/s] 55%|█████▍    | 158/288 [00:09<00:07, 16.29it/s] 56%|█████▌    | 160/288 [00:09<00:07, 16.30it/s] 56%|█████▋    | 162/288 [00:09<00:07, 16.31it/s] 57%|█████▋    | 164/288 [00:10<00:07, 16.30it/s] 58%|█████▊    | 166/288 [00:10<00:07, 16.31it/s] 58%|█████▊    | 168/288 [00:10<00:07, 16.29it/s] 59%|█████▉    | 170/288 [00:10<00:07, 16.29it/s] 60%|█████▉    | 172/288 [00:10<00:07, 16.30it/s] 60%|██████    | 174/288 [00:10<00:06, 16.30it/s] 61%|██████    | 176/288 [00:10<00:06, 16.30it/s] 62%|██████▏   | 178/288 [00:10<00:06, 16.30it/s] 62%|██████▎   | 180/288 [00:11<00:06, 16.31it/s] 63%|██████▎   | 182/288 [00:11<00:06, 16.30it/s] 64%|██████▍   | 184/288 [00:11<00:06, 16.29it/s] 65%|██████▍   | 186/288 [00:11<00:06, 16.30it/s] 65%|██████▌   | 188/288 [00:11<00:06, 16.29it/s] 66%|██████▌   | 190/288 [00:11<00:06, 16.24it/s] 67%|██████▋   | 192/288 [00:11<00:05, 16.23it/s] 67%|██████▋   | 194/288 [00:11<00:05, 16.25it/s] 68%|██████▊   | 196/288 [00:12<00:05, 16.27it/s] 69%|██████▉   | 198/288 [00:12<00:05, 16.28it/s] 69%|██████▉   | 200/288 [00:12<00:05, 16.29it/s] 70%|███████   | 202/288 [00:12<00:05, 16.28it/s] 71%|███████   | 204/288 [00:12<00:05, 16.28it/s] 72%|███████▏  | 206/288 [00:12<00:05, 16.29it/s] 72%|███████▏  | 208/288 [00:12<00:04, 16.29it/s] 73%|███████▎  | 210/288 [00:12<00:04, 16.28it/s] 74%|███████▎  | 212/288 [00:13<00:04, 16.30it/s] 74%|███████▍  | 214/288 [00:13<00:04, 16.31it/s] 75%|███████▌  | 216/288 [00:13<00:04, 16.31it/s] 76%|███████▌  | 218/288 [00:13<00:04, 16.31it/s] 76%|███████▋  | 220/288 [00:13<00:04, 16.30it/s] 77%|███████▋  | 222/288 [00:13<00:04, 16.31it/s] 78%|███████▊  | 224/288 [00:13<00:03, 16.30it/s] 78%|███████▊  | 226/288 [00:13<00:03, 16.30it/s] 79%|███████▉  | 228/288 [00:13<00:03, 16.32it/s] 80%|███████▉  | 230/288 [00:14<00:03, 16.32it/s] 81%|████████  | 232/288 [00:14<00:03, 16.31it/s] 81%|████████▏ | 234/288 [00:14<00:03, 16.29it/s] 82%|████████▏ | 236/288 [00:14<00:03, 16.28it/s] 83%|████████▎ | 238/288 [00:14<00:03, 16.29it/s] 83%|████████▎ | 240/288 [00:14<00:02, 16.28it/s] 84%|████████▍ | 242/288 [00:14<00:02, 16.27it/s] 85%|████████▍ | 244/288 [00:14<00:02, 16.28it/s] 85%|████████▌ | 246/288 [00:15<00:02, 16.25it/s] 86%|████████▌ | 248/288 [00:15<00:02, 16.25it/s] 87%|████████▋ | 250/288 [00:15<00:02, 16.26it/s] 88%|████████▊ | 252/288 [00:15<00:02, 16.26it/s] 88%|████████▊ | 254/288 [00:15<00:02, 16.26it/s] 89%|████████▉ | 256/288 [00:15<00:01, 16.28it/s] 90%|████████▉ | 258/288 [00:15<00:01, 16.27it/s] 90%|█████████ | 260/288 [00:15<00:01, 16.27it/s] 91%|█████████ | 262/288 [00:16<00:01, 16.26it/s] 92%|█████████▏| 264/288 [00:16<00:01, 16.28it/s] 92%|█████████▏| 266/288 [00:16<00:01, 16.27it/s] 93%|█████████▎| 268/288 [00:16<00:01, 16.27it/s] 94%|█████████▍| 270/288 [00:16<00:01, 16.28it/s] 94%|█████████▍| 272/288 [00:16<00:00, 16.27it/s] 95%|█████████▌| 274/288 [00:16<00:00, 16.28it/s] 96%|█████████▌| 276/288 [00:16<00:00, 16.28it/s] 97%|█████████▋| 278/288 [00:17<00:00, 16.29it/s] 97%|█████████▋| 280/288 [00:17<00:00, 16.30it/s] 98%|█████████▊| 282/288 [00:17<00:00, 16.30it/s] 99%|█████████▊| 284/288 [00:17<00:00, 16.31it/s] 99%|█████████▉| 286/288 [00:17<00:00, 16.30it/s]100%|██████████| 288/288 [00:17<00:00, 16.32it/s]
Running POT with q=0.001, level=0.9..
Initial threshold : 0.052626155
Number of peaks : 5821
Grimshaw maximum log-likelihood estimation ... [done]
	γ = -0.007150015328079462
	σ = 0.07174204874316394
	L = 9557.082324355564
Extreme quantile (probability = 0.001): 0.37762207477208853
  0%|          | 0/73629 [00:00<?, ?it/s]100%|██████████| 73629/73629 [00:00<00:00, 5188199.87it/s]
0
73629
Finding best f1-score by searching for threshold..
Results using epsilon method:
 {'f1': 0.8564237837622064, 'precision': 0.7805679161045053, 'recall': 0.9486221981089078, 'TP': 7367, 'TN': 63792, 'FP': 2071, 'FN': 399, 'ROC/AUC': 0.9585890706048852, 'threshold': 0.14441942982375622, 'latency': 23.5624263674176, 'reg_level': 0}
Results using peak-over-threshold method:
 {'f1': 0.7248579820399254, 'precision': 0.9271669323291194, 'recall': 0.5950296155098769, 'TP': 4621, 'TN': 65500, 'FP': 363, 'FN': 3145, 'ROC/AUC': 0.7947590879309412, 'threshold': 0.3776220747720886, 'latency': 28.849855750721247}
Results using best f1 score search:
 {'f1': 0.9190509774689068, 'precision': 0.9281680880785712, 'recall': 0.910121039260725, 'TP': 7068, 'TN': 65316, 'FP': 547, 'FN': 698, 'ROC/AUC': 0.9509079611163778, 'threshold': 0.3085000000000001, 'latency': 40.896410702032064}
Saving output to output/mypkg_MSL/01052024_130456/<train/test>_output.pkl
-- Done.
